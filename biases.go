package hll

import (
	"fmt"
	"sort"
)

// NOTE: maxTick is just ticks[len(ticks)-1], but is copied out since it _should_ get loaded into CPU
// cache more frequently if it's not a fn() that has an array lookup.
type biases struct {
	ticks   []int
	maxTick uint64

	store map[int]float64
}

// getInterpolatedBias returns the average bias for the 4 nearest neighbors to estimate.
func (b *biases) getInterpolatedBias(estimate int) float64 {
	sum := 0.0
	neighbourTicks := b.getNeighbourTicks(estimate)

	for _, neighbourTick := range neighbourTicks {
		sum += b.store[neighbourTick]
	}

	return sum / float64(len(neighbourTicks))
}

func (b *biases) getNeighbourTicks(estimate int) []int {
	// If estimate <= biasTicks[1], return first 4 to prevent underflow.
	if estimate <= b.ticks[2] {
		return b.ticks[0:4]
	}

	// If estimate >= biasTicks[MAX-3], return final 4 to prevent overflow.
	if estimate >= b.ticks[len(b.ticks)-2] {
		l := len(b.ticks)
		return b.ticks[l-4 : l]
	}

	// Find the point we tip over the estimate, return the 2 points higher and the 2 lower.
	i := 2
	for ; i < len(b.ticks); i++ {
		if b.ticks[i] > estimate {
			break
		}
	}

	return b.ticks[i-2 : i+2]
}

func createBiases(bs map[int]float64) *biases {
	ticks := make([]int, len(bs))

	i := 0
	for tick := range bs {
		ticks[i] = tick
		i += 1
	}

	sort.Ints(ticks)
	return &biases{
		ticks:   ticks,
		maxTick: uint64(ticks[len(ticks)-1]),

		store: bs,
	}
}

var defaultBiases = createBiases(defaultGeneratedBiases)

// Package level store for custom generated rawEstimate -> bias maps. Allows for use of a single
// *biases across multiple Sketch instances, whilst ensuring that both the given map remains immutable
// (from our perspective) and we don't have to complicate the API by having to expose biases or a
// builder externally.
var biasStore = map[string]*biases{}

// RegisterBiases allows a custom set of biases to be registered for use in NewCustomSketch.
func RegisterBiases(key string, biases map[int]float64) error {
	if key == "" {
		return fmt.Errorf("invalid bias key given for registration")
	}

	if len(biases) < 4 {
		return fmt.Errorf("invalid biases: valid biases must contain at least 4 interpolation points")
	}

	// Copy biases to stop any chance of sneaky external changes to biases having an effect on this package.
	ourCopy := make(map[int]float64)

	for tick, bias := range biases {
		ourCopy[tick] = bias
	}

	biasStore[key] = createBiases(ourCopy)

	return nil
}

// (Discussed in generate.go)
var defaultGeneratedBiases = map[int]float64{
	108:    0.463815,
	216:    0.463931,
	323:    0.464059,
	431:    0.464616,
	538:    0.465083,
	645:    0.465417,
	751:    0.465897,
	858:    0.466404,
	964:    0.466929,
	1070:   0.467412,
	1176:   0.467875,
	1281:   0.468398,
	1387:   0.468855,
	1492:   0.469315,
	1597:   0.46978,
	1701:   0.470271,
	1806:   0.470776,
	1910:   0.471305,
	2014:   0.471771,
	2118:   0.472282,
	2221:   0.472774,
	2324:   0.473325,
	2427:   0.47382,
	2530:   0.474315,
	2633:   0.474827,
	2735:   0.475332,
	2837:   0.475847,
	2939:   0.476335,
	3041:   0.476825,
	3143:   0.477332,
	3244:   0.477839,
	3345:   0.478324,
	3446:   0.478836,
	3547:   0.479364,
	3647:   0.479848,
	3747:   0.48035,
	3847:   0.480861,
	3947:   0.481369,
	4047:   0.481873,
	4146:   0.482397,
	4245:   0.482891,
	4345:   0.483388,
	4443:   0.483886,
	4542:   0.484405,
	4640:   0.484921,
	4738:   0.485453,
	4836:   0.485937,
	4934:   0.486432,
	5032:   0.486943,
	5129:   0.487428,
	5226:   0.487931,
	5323:   0.488442,
	5420:   0.488945,
	5517:   0.489432,
	5613:   0.489927,
	5710:   0.490403,
	5806:   0.49091,
	5902:   0.491412,
	5997:   0.491919,
	6093:   0.492425,
	6188:   0.492938,
	6283:   0.493454,
	6377:   0.49399,
	6471:   0.494508,
	6566:   0.495004,
	6660:   0.495505,
	6754:   0.496021,
	6848:   0.496521,
	6942:   0.497009,
	7035:   0.49753,
	7128:   0.498039,
	7221:   0.498538,
	7314:   0.499034,
	7407:   0.499543,
	7500:   0.500042,
	7592:   0.500548,
	7684:   0.501055,
	7776:   0.501567,
	7868:   0.502073,
	7959:   0.502587,
	8051:   0.503084,
	8142:   0.503601,
	8233:   0.504104,
	8324:   0.504603,
	8414:   0.505108,
	8505:   0.505621,
	8595:   0.506128,
	8685:   0.506623,
	8775:   0.507123,
	8865:   0.50762,
	8955:   0.508126,
	9044:   0.508618,
	9134:   0.509108,
	9223:   0.509619,
	9311:   0.510144,
	9400:   0.510659,
	9489:   0.511156,
	9577:   0.511664,
	9665:   0.512158,
	9753:   0.51267,
	9841:   0.513171,
	9929:   0.513689,
	10016:  0.51419,
	10103:  0.514699,
	10190:  0.515219,
	10277:  0.51573,
	10364:  0.516232,
	10451:  0.516735,
	10537:  0.517236,
	10623:  0.51774,
	10710:  0.518241,
	10796:  0.518745,
	10881:  0.519257,
	10967:  0.519763,
	11052:  0.52027,
	11137:  0.52078,
	11223:  0.52129,
	11307:  0.521799,
	11392:  0.522315,
	11477:  0.522817,
	11561:  0.523322,
	11645:  0.523825,
	11730:  0.524327,
	11814:  0.524833,
	11898:  0.525326,
	11981:  0.525831,
	12065:  0.526335,
	12148:  0.526843,
	12231:  0.527345,
	12315:  0.527848,
	12397:  0.528352,
	12480:  0.528857,
	12563:  0.529351,
	12645:  0.52986,
	12727:  0.53037,
	12809:  0.530873,
	12891:  0.531382,
	12973:  0.531885,
	13055:  0.532387,
	13136:  0.532884,
	13218:  0.533387,
	13299:  0.533889,
	13380:  0.534385,
	13461:  0.53488,
	13542:  0.535375,
	13623:  0.535878,
	13703:  0.536377,
	13784:  0.536868,
	13864:  0.537369,
	13944:  0.537873,
	14024:  0.538368,
	14104:  0.538866,
	14184:  0.539365,
	14263:  0.539866,
	14342:  0.540377,
	14421:  0.540882,
	14500:  0.541376,
	14579:  0.541875,
	14658:  0.542369,
	14737:  0.542872,
	14815:  0.543371,
	14894:  0.543874,
	14972:  0.544374,
	15049:  0.544884,
	15127:  0.545379,
	15205:  0.545882,
	15283:  0.546382,
	15360:  0.546883,
	15438:  0.547382,
	15514:  0.547889,
	15591:  0.54839,
	15669:  0.548886,
	15745:  0.549382,
	15822:  0.549882,
	15898:  0.550382,
	15975:  0.550881,
	16051:  0.551379,
	16127:  0.551876,
	16203:  0.552375,
	16279:  0.552873,
	16354:  0.553381,
	16430:  0.55388,
	16505:  0.554377,
	16581:  0.554875,
	16656:  0.555377,
	16731:  0.555869,
	16806:  0.556372,
	16881:  0.556863,
	16955:  0.557364,
	17029:  0.55787,
	17104:  0.55836,
	17178:  0.558862,
	17252:  0.559355,
	17326:  0.55986,
	17400:  0.560362,
	17474:  0.56086,
	17547:  0.561358,
	17620:  0.561861,
	17694:  0.562359,
	17767:  0.562855,
	17840:  0.563347,
	17913:  0.563846,
	17986:  0.564343,
	18059:  0.564837,
	18131:  0.565339,
	18204:  0.565827,
	18276:  0.56632,
	18348:  0.566823,
	18421:  0.567315,
	18493:  0.567807,
	18564:  0.568303,
	18636:  0.56881,
	18707:  0.569311,
	18778:  0.569815,
	18850:  0.570309,
	18921:  0.570806,
	18992:  0.571305,
	19063:  0.571807,
	19134:  0.572296,
	19205:  0.572795,
	19276:  0.57328,
	19346:  0.57378,
	19416:  0.574274,
	19487:  0.574769,
	19557:  0.575265,
	19627:  0.575759,
	19696:  0.57626,
	19766:  0.576758,
	19836:  0.577261,
	19905:  0.57775,
	19991:  0.578367,
	20077:  0.578984,
	20163:  0.579597,
	20248:  0.580205,
	20334:  0.580817,
	20419:  0.581419,
	20504:  0.582035,
	20590:  0.582638,
	20674:  0.58325,
	20759:  0.58385,
	20844:  0.584459,
	20928:  0.585071,
	21012:  0.585679,
	21097:  0.58627,
	21180:  0.586874,
	21264:  0.587474,
	21348:  0.588078,
	21431:  0.588687,
	21515:  0.589285,
	21598:  0.589891,
	21680:  0.5905,
	21763:  0.591107,
	21845:  0.591714,
	21928:  0.592313,
	22010:  0.592918,
	22092:  0.593524,
	22174:  0.594125,
	22256:  0.594737,
	22337:  0.595347,
	22418:  0.595958,
	22499:  0.596569,
	22580:  0.597176,
	22661:  0.597783,
	22742:  0.598386,
	22823:  0.598983,
	22903:  0.599591,
	22983:  0.600194,
	23063:  0.600795,
	23143:  0.601397,
	23223:  0.601997,
	23303:  0.602596,
	23383:  0.603191,
	23462:  0.603789,
	23542:  0.604392,
	23621:  0.604996,
	23699:  0.605596,
	23778:  0.606202,
	23857:  0.606803,
	23935:  0.607408,
	24014:  0.608003,
	24092:  0.608604,
	24170:  0.609204,
	24248:  0.609799,
	24326:  0.610394,
	24404:  0.61099,
	24481:  0.611592,
	24558:  0.612196,
	24635:  0.612799,
	24712:  0.613396,
	24789:  0.613992,
	24866:  0.614584,
	24943:  0.615179,
	25019:  0.615774,
	25096:  0.616365,
	25172:  0.616963,
	25249:  0.617554,
	25325:  0.618144,
	25401:  0.618734,
	25477:  0.619323,
	25552:  0.61992,
	25628:  0.620516,
	25703:  0.621102,
	25778:  0.621698,
	25854:  0.622287,
	25929:  0.622877,
	26004:  0.623461,
	26079:  0.624052,
	26153:  0.624637,
	26228:  0.625226,
	26302:  0.625814,
	26377:  0.626401,
	26451:  0.62699,
	26525:  0.627568,
	26599:  0.628153,
	26673:  0.628738,
	26747:  0.629326,
	26820:  0.629914,
	26893:  0.630504,
	26967:  0.631092,
	27039:  0.631684,
	27113:  0.632267,
	27185:  0.632852,
	27258:  0.633432,
	27331:  0.634014,
	27404:  0.63459,
	27476:  0.635175,
	27549:  0.635755,
	27621:  0.63634,
	27693:  0.63693,
	27764:  0.637521,
	27836:  0.6381,
	27908:  0.638678,
	27980:  0.639267,
	28051:  0.639852,
	28122:  0.640435,
	28193:  0.641017,
	28265:  0.641593,
	28336:  0.64217,
	28407:  0.642749,
	28477:  0.643329,
	28548:  0.643911,
	28618:  0.644496,
	28689:  0.645077,
	28759:  0.645654,
	28829:  0.646233,
	28900:  0.646805,
	28970:  0.647376,
	29040:  0.647946,
	29110:  0.64852,
	29180:  0.649099,
	29249:  0.649674,
	29319:  0.650244,
	29388:  0.650816,
	29458:  0.651386,
	29527:  0.651955,
	29596:  0.652526,
	29665:  0.653099,
	29734:  0.653678,
	29803:  0.654242,
	29872:  0.654817,
	29940:  0.655385,
	30009:  0.655953,
	30077:  0.656525,
	30146:  0.657093,
	30214:  0.657656,
	30282:  0.658227,
	30350:  0.658791,
	30418:  0.659355,
	30486:  0.659925,
	30554:  0.660487,
	30621:  0.661056,
	30689:  0.661625,
	30756:  0.662191,
	30824:  0.662751,
	30891:  0.663319,
	30958:  0.66388,
	31025:  0.664438,
	31092:  0.665002,
	31159:  0.665573,
	31226:  0.666135,
	31292:  0.666698,
	31359:  0.667254,
	31425:  0.667821,
	31492:  0.668377,
	31558:  0.668938,
	31624:  0.669497,
	31691:  0.670048,
	31757:  0.670608,
	31823:  0.671162,
	31889:  0.671714,
	31955:  0.672274,
	32021:  0.672829,
	32087:  0.673381,
	32152:  0.673936,
	32218:  0.674491,
	32283:  0.675054,
	32348:  0.675602,
	32413:  0.676155,
	32479:  0.676706,
	32543:  0.677261,
	32608:  0.677814,
	32673:  0.678367,
	32738:  0.678919,
	32803:  0.679465,
	32868:  0.680014,
	32932:  0.680563,
	32996:  0.681117,
	33061:  0.681667,
	33125:  0.682214,
	33189:  0.682761,
	33254:  0.68331,
	33318:  0.683853,
	33382:  0.684398,
	33446:  0.684941,
	33510:  0.685482,
	33589:  0.686164,
	33668:  0.686841,
	33747:  0.687519,
	33825:  0.688197,
	33904:  0.688874,
	33983:  0.689543,
	34061:  0.690216,
	34139:  0.690886,
	34218:  0.691552,
	34296:  0.692222,
	34374:  0.69289,
	34452:  0.693566,
	34529:  0.694235,
	34607:  0.694898,
	34684:  0.69557,
	34762:  0.696235,
	34839:  0.696896,
	34917:  0.697559,
	34994:  0.698222,
	35070:  0.698894,
	35148:  0.699551,
	35224:  0.700215,
	35301:  0.700872,
	35378:  0.701532,
	35454:  0.702184,
	35531:  0.702843,
	35607:  0.703496,
	35683:  0.704151,
	35760:  0.704798,
	35836:  0.705455,
	35912:  0.70611,
	35987:  0.706767,
	36063:  0.707421,
	36139:  0.708068,
	36214:  0.708718,
	36289:  0.709373,
	36364:  0.710022,
	36440:  0.710671,
	36514:  0.711323,
	36589:  0.711977,
	36664:  0.712624,
	36739:  0.713266,
	36814:  0.713905,
	36888:  0.71455,
	36963:  0.715196,
	37037:  0.715837,
	37111:  0.716481,
	37186:  0.717118,
	37260:  0.717751,
	37334:  0.718386,
	37408:  0.719025,
	37482:  0.719658,
	37556:  0.720292,
	37630:  0.720932,
	37704:  0.721566,
	37777:  0.722205,
	37850:  0.722843,
	37923:  0.723474,
	37997:  0.724103,
	38070:  0.72473,
	38143:  0.725366,
	38216:  0.725995,
	38289:  0.726627,
	38362:  0.72725,
	38434:  0.727879,
	38507:  0.728505,
	38580:  0.729129,
	38652:  0.729759,
	38724:  0.730383,
	38797:  0.731003,
	38869:  0.73162,
	38941:  0.732242,
	39014:  0.73286,
	39086:  0.733481,
	39158:  0.734094,
	39230:  0.734714,
	39302:  0.735331,
	39373:  0.73595,
	39444:  0.736571,
	39516:  0.737184,
	39588:  0.737796,
	39659:  0.73841,
	39730:  0.739021,
	39801:  0.739641,
	39872:  0.740252,
	39943:  0.740866,
	40015:  0.741469,
	40086:  0.742076,
	40157:  0.742684,
	40227:  0.743295,
	40298:  0.743902,
	40369:  0.744506,
	40440:  0.745103,
	40510:  0.745711,
	40580:  0.746311,
	40651:  0.746902,
	40722:  0.747506,
	40792:  0.748105,
	40862:  0.748698,
	40933:  0.749294,
	41003:  0.749889,
	41073:  0.750485,
	41143:  0.751074,
	41213:  0.751664,
	41283:  0.752257,
	41353:  0.752843,
	41423:  0.75343,
	41493:  0.754018,
	41563:  0.754606,
	41632:  0.755197,
	41702:  0.755792,
	41771:  0.756383,
	41840:  0.756964,
	41910:  0.757552,
	41979:  0.758138,
	42048:  0.758724,
	42117:  0.759304,
	42186:  0.759887,
	42255:  0.760466,
	42325:  0.761041,
	42394:  0.761616,
	42463:  0.76219,
	42532:  0.762769,
	42600:  0.763348,
	42669:  0.763924,
	42737:  0.764501,
	42806:  0.765073,
	42875:  0.76564,
	42943:  0.76621,
	43012:  0.766783,
	43080:  0.767355,
	43149:  0.767916,
	43217:  0.76848,
	43286:  0.769046,
	43354:  0.769614,
	43422:  0.770183,
	43490:  0.770747,
	43558:  0.77131,
	43626:  0.771875,
	43694:  0.772433,
	43762:  0.772988,
	43830:  0.773545,
	43898:  0.774102,
	43966:  0.774659,
	44034:  0.775217,
	44101:  0.775776,
	44169:  0.77633,
	44237:  0.776879,
	44304:  0.777435,
	44389:  0.778125,
	44472:  0.778824,
	44556:  0.779517,
	44639:  0.780202,
	44723:  0.780885,
	44807:  0.781568,
	44891:  0.782248,
	44974:  0.78293,
	45058:  0.783615,
	45141:  0.78429,
	45225:  0.784966,
	45308:  0.785637,
	45392:  0.786307,
	45475:  0.786976,
	45559:  0.787636,
	45642:  0.788301,
	45725:  0.788972,
	45808:  0.78964,
	45891:  0.790302,
	45974:  0.790962,
	46057:  0.791625,
	46139:  0.792292,
	46222:  0.792946,
	46305:  0.793597,
	46388:  0.794257,
	46471:  0.794906,
	46553:  0.795561,
	46636:  0.796209,
	46718:  0.796866,
	46800:  0.797511,
	46883:  0.79816,
	46965:  0.798809,
	47047:  0.799449,
	47129:  0.800094,
	47212:  0.800732,
	47294:  0.801364,
	47376:  0.802005,
	47458:  0.80265,
	47540:  0.803282,
	47622:  0.803912,
	47704:  0.804545,
	47786:  0.805175,
	47867:  0.805807,
	47949:  0.806434,
	48031:  0.807067,
	48112:  0.807692,
	48194:  0.808313,
	48276:  0.808937,
	48357:  0.809554,
	48439:  0.81017,
	48521:  0.810786,
	48602:  0.81141,
	48683:  0.812021,
	48765:  0.812635,
	48846:  0.813254,
	48927:  0.813861,
	49009:  0.814469,
	49090:  0.81507,
	49171:  0.815679,
	49252:  0.816286,
	49333:  0.816895,
	49414:  0.817497,
	49495:  0.818101,
	49577:  0.818694,
	49657:  0.819296,
	49738:  0.819893,
	49819:  0.82049,
	49900:  0.82109,
	49981:  0.821679,
	50061:  0.822276,
	50142:  0.822858,
	50223:  0.823443,
	50304:  0.824031,
	50384:  0.824621,
	50465:  0.825204,
	50546:  0.825784,
	50627:  0.826362,
	50707:  0.82694,
	50788:  0.827515,
	50869:  0.828094,
	50949:  0.828668,
	51030:  0.829245,
	51110:  0.829816,
	51191:  0.830389,
	51271:  0.830958,
	51351:  0.831527,
	51431:  0.832099,
	51512:  0.832667,
	51593:  0.833223,
	51673:  0.833783,
	51753:  0.834351,
	51833:  0.834909,
	51913:  0.835472,
	51994:  0.836025,
	52074:  0.836578,
	52155:  0.837127,
	52235:  0.837677,
	52315:  0.838228,
	52396:  0.838773,
	52476:  0.839316,
	52557:  0.839853,
	52637:  0.840399,
	52717:  0.840942,
	52797:  0.841484,
	52877:  0.842029,
	52957:  0.842571,
	53037:  0.843115,
	53117:  0.843657,
	53196:  0.844196,
	53276:  0.844734,
	53356:  0.845271,
	53436:  0.845804,
	53516:  0.846331,
	53596:  0.846862,
	53675:  0.847394,
	53756:  0.847915,
	53835:  0.848442,
	53915:  0.848966,
	53995:  0.849496,
	54074:  0.850021,
	54174:  0.850671,
	54274:  0.851312,
	54373:  0.851966,
	54473:  0.852612,
	54573:  0.853253,
	54672:  0.85389,
	54772:  0.854528,
	54872:  0.855156,
	54972:  0.855784,
	55072:  0.856415,
	55171:  0.857045,
	55271:  0.857675,
	55370:  0.858301,
	55470:  0.85892,
	55569:  0.85955,
	55668:  0.86017,
	55768:  0.86079,
	55868:  0.861398,
	55967:  0.862006,
	56067:  0.862624,
	56166:  0.863229,
	56266:  0.863831,
	56365:  0.864441,
	56465:  0.865039,
	56564:  0.865642,
	56663:  0.866244,
	56763:  0.866839,
	56862:  0.867439,
	56962:  0.868025,
	57062:  0.868611,
	57161:  0.8692,
	57261:  0.869781,
	57361:  0.870362,
	57460:  0.870949,
	57559:  0.871525,
	57659:  0.872101,
	57759:  0.872674,
	57858:  0.873248,
	57958:  0.873815,
	58057:  0.874393,
	58157:  0.874957,
	58256:  0.875528,
	58355:  0.876091,
	58455:  0.876656,
	58555:  0.877202,
	58654:  0.877763,
	58753:  0.878325,
	58853:  0.878881,
	58952:  0.879434,
	59052:  0.879986,
	59151:  0.88053,
	59251:  0.881072,
	59351:  0.881611,
	59450:  0.882155,
	59550:  0.882692,
	59649:  0.883236,
	59749:  0.883772,
	59849:  0.884303,
	59948:  0.884836,
	60048:  0.885365,
	60149:  0.885884,
	60248:  0.886408,
	60348:  0.886932,
	60448:  0.887454,
	60548:  0.887973,
	60648:  0.888486,
	60747:  0.889008,
	60847:  0.889524,
	60946:  0.89004,
	61046:  0.890557,
	61145:  0.891068,
	61245:  0.891572,
	61345:  0.892073,
	61445:  0.892576,
	61545:  0.893074,
	61645:  0.893574,
	61746:  0.894066,
	61846:  0.894556,
	61946:  0.895043,
	62046:  0.895535,
	62147:  0.896023,
	62246:  0.896517,
	62347:  0.896992,
	62448:  0.897466,
	62548:  0.897948,
	62648:  0.898432,
	62748:  0.898906,
	62849:  0.899375,
	62949:  0.899845,
	63050:  0.90032,
	63150:  0.900794,
	63250:  0.901262,
	63350:  0.901732,
	63450:  0.902201,
	63550:  0.902665,
	63676:  0.903239,
	63802:  0.903805,
	63927:  0.904383,
	64053:  0.904957,
	64178:  0.905522,
	64304:  0.906088,
	64430:  0.906645,
	64555:  0.907207,
	64682:  0.907748,
	64808:  0.908292,
	64935:  0.908837,
	65060:  0.909386,
	65187:  0.909925,
	65313:  0.910463,
	65440:  0.910985,
	65566:  0.911522,
	65693:  0.912044,
	65820:  0.912569,
	65946:  0.91309,
	66072:  0.91362,
	66198:  0.914146,
	66325:  0.914656,
	66452:  0.91517,
	66579:  0.915681,
	66705:  0.916193,
	66832:  0.916699,
	66959:  0.917198,
	67086:  0.917699,
	67213:  0.918198,
	67341:  0.918687,
	67468:  0.919177,
	67596:  0.919663,
	67723:  0.92015,
	67849:  0.920646,
	67976:  0.921137,
	68103:  0.92162,
	68229:  0.922115,
	68357:  0.922588,
	68484:  0.923066,
	68611:  0.923546,
	68738:  0.924017,
	68866:  0.924477,
	68993:  0.924949,
	69121:  0.925408,
	69249:  0.92587,
	69376:  0.92633,
	69503:  0.926793,
	69631:  0.927248,
	69759:  0.9277,
	69886:  0.928152,
	70015:  0.928597,
	70142:  0.929055,
	70269:  0.929502,
	70398:  0.929933,
	70526:  0.930372,
	70654:  0.930811,
	70782:  0.93125,
	70910:  0.93168,
	71039:  0.932105,
	71167:  0.932531,
	71295:  0.932957,
	71424:  0.933372,
	71553:  0.933785,
	71681:  0.934208,
	71810:  0.934626,
	71939:  0.935029,
	72069:  0.935434,
	72197:  0.935844,
	72327:  0.936245,
	72456:  0.93664,
	72586:  0.937035,
	72715:  0.937436,
	72844:  0.937834,
	72973:  0.938233,
	73102:  0.938628,
	73232:  0.939015,
	73360:  0.939414,
	73523:  0.93988,
	73685:  0.940354,
	73846:  0.940829,
	74009:  0.94129,
	74171:  0.941754,
	74333:  0.942219,
	74495:  0.94268,
	74656:  0.94315,
	74818:  0.943609,
	74981:  0.944054,
	75142:  0.94451,
	75305:  0.944947,
	75468:  0.945393,
	75630:  0.945837,
	75793:  0.946266,
	75957:  0.946696,
	76120:  0.947117,
	76283:  0.947549,
	76447:  0.947963,
	76610:  0.948379,
	76773:  0.948802,
	76937:  0.949214,
	77100:  0.949633,
	77263:  0.950046,
	77427:  0.950452,
	77590:  0.950862,
	77755:  0.951251,
	77919:  0.951648,
	78083:  0.952049,
	78248:  0.952431,
	78413:  0.952811,
	78578:  0.953192,
	78743:  0.953574,
	78909:  0.953935,
	79075:  0.954301,
	79241:  0.954662,
	79406:  0.955031,
	79571:  0.955399,
	79737:  0.955757,
	79902:  0.95612,
	80067:  0.956487,
	80233:  0.95684,
	80400:  0.957181,
	80566:  0.95753,
	80731:  0.957886,
	80897:  0.958233,
	81063:  0.958572,
	81230:  0.958908,
	81396:  0.959249,
	81563:  0.959578,
	81729:  0.95992,
	81896:  0.96025,
	82063:  0.960571,
	82228:  0.960915,
	82395:  0.961238,
	82561:  0.96157,
	82728:  0.96189,
	82894:  0.962222,
	83061:  0.962533,
	83229:  0.962842,
	83396:  0.963152,
	83606:  0.963528,
	83814:  0.963908,
	84024:  0.964282,
	84233:  0.964653,
	84443:  0.96501,
	84651:  0.965389,
	84861:  0.965753,
	85071:  0.966105,
	85281:  0.966457,
	85490:  0.966822,
	85700:  0.967174,
	85909:  0.967535,
	86119:  0.96788,
	86330:  0.968208,
	86541:  0.968545,
	86752:  0.968869,
	86963:  0.969196,
	87174:  0.969527,
	87385:  0.969855,
	87596:  0.970173,
	87808:  0.970485,
	88019:  0.970808,
	88232:  0.971108,
	88444:  0.971419,
	88655:  0.971725,
	88868:  0.972027,
	89081:  0.972314,
	89294:  0.972609,
	89507:  0.972892,
	89719:  0.973188,
	89933:  0.973464,
	90146:  0.973754,
	90360:  0.974029,
	90573:  0.974309,
	90786:  0.97459,
	91000:  0.974857,
	91213:  0.975134,
	91426:  0.975408,
	91641:  0.975668,
	91855:  0.97593,
	92070:  0.976185,
	92284:  0.976441,
	92498:  0.976699,
	92713:  0.976952,
	92928:  0.977196,
	93145:  0.977428,
	93360:  0.977672,
	93573:  0.97793,
	93789:  0.978166,
	94006:  0.978389,
	94274:  0.978692,
	94543:  0.978981,
	94814:  0.979261,
	95084:  0.979533,
	95355:  0.979801,
	95625:  0.980078,
	95895:  0.980359,
	96166:  0.980616,
	96438:  0.980867,
	96708:  0.981142,
	96978:  0.981411,
	97249:  0.981668,
	97521:  0.98192,
	97792:  0.982166,
	98065:  0.982402,
	98337:  0.982642,
	98609:  0.982882,
	98882:  0.983121,
	99154:  0.98335,
	99428:  0.983574,
	99700:  0.983804,
	99973:  0.984031,
	100246: 0.984251,
	100519: 0.984474,
	100793: 0.984693,
	101066: 0.984911,
	101340: 0.985122,
	101613: 0.985334,
	101888: 0.985532,
	102163: 0.985725,
	102438: 0.985925,
	102713: 0.986115,
	102988: 0.986311,
	103263: 0.986497,
	103540: 0.986672,
	103816: 0.986856,
	104091: 0.987039,
	104367: 0.98722,
	104644: 0.987383,
	104988: 0.987611,
	105332: 0.987827,
	105678: 0.988029,
	106023: 0.98824,
	106368: 0.988442,
	106715: 0.988637,
	107060: 0.988843,
	107404: 0.98905,
	107748: 0.989263,
	108094: 0.989454,
	108440: 0.989648,
	108787: 0.989824,
	109134: 0.990003,
	109481: 0.990187,
	109828: 0.990363,
	110174: 0.99055,
	110523: 0.990706,
	110870: 0.990879,
	111218: 0.991037,
	111567: 0.99119,
	111917: 0.991336,
	112265: 0.991494,
	112614: 0.99165,
	112960: 0.991823,
	113310: 0.991966,
	113659: 0.992112,
	114009: 0.992253,
	114358: 0.992394,
	114709: 0.992529,
	115058: 0.992673,
	115406: 0.992822,
}
